<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="en">
<head>
    <meta charset="UTF-8">
    <title>SkyTicket - Trang Ch√≠nh</title>
    <link rel="stylesheet" th:href="@{/main.css}">
    <style>
        @keyframes slideDown {
            from {
                opacity: 0;
                transform: translateY(-50px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes checkmark {
            0% {
                transform: scale(0) rotate(45deg);
            }
            50% {
                transform: scale(1.2) rotate(45deg);
            }
            100% {
                transform: scale(1) rotate(45deg);
            }
        }

        @keyframes fadeOut {
            from {
                opacity: 1;
                transform: translateY(0);
            }
            to {
                opacity: 0;
                transform: translateY(-20px);
            }
        }

        .success-notification {
            position: fixed;
            top: 20px;
            right: 20px;
            background: linear-gradient(135deg, #28a745, #20c997);
            color: white;
            padding: 20px 30px;
            border-radius: 12px;
            box-shadow: 0 8px 25px rgba(40, 167, 69, 0.4);
            z-index: 1000;
            display: flex;
            align-items: center;
            gap: 15px;
            animation: slideDown 0.5s ease-out;
            min-width: 300px;
            max-width: 400px;
        }

        .success-notification.hide {
            animation: fadeOut 0.5s ease-out forwards;
        }

        .success-icon {
            width: 40px;
            height: 40px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            flex-shrink: 0;
        }

        .success-icon::before {
            content: '‚úì';
            color: white;
            font-weight: bold;
            animation: checkmark 0.6s ease-out;
        }

        .success-content {
            flex: 1;
        }

        .success-title {
            font-weight: 700;
            font-size: 18px;
            margin-bottom: 5px;
        }

        .success-message {
            font-size: 14px;
            opacity: 0.95;
        }

        .success-close {
            background: rgba(255, 255, 255, 0.2);
            border: none;
            color: white;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            cursor: pointer;
            font-size: 18px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
            flex-shrink: 0;
        }

        .success-close:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: rotate(90deg);
        }
    </style>
</head>
<body>

<!-- Th√¥ng b√°o ƒëƒÉng nh·∫≠p th√†nh c√¥ng -->
<div th:if="${loginSuccess}" id="successNotification" class="success-notification">
    <div class="success-icon"></div>
    <div class="success-content">
        <div class="success-title">üéâ ƒêƒÉng nh·∫≠p th√†nh c√¥ng!</div>
        <div class="success-message">
            <span th:if="${user != null and user.fullName != null}" th:text="'Ch√∫c m·ª´ng b·∫°n ' + ${user.fullName} + '!'">Ch√∫c m·ª´ng b·∫°n!</span>
           
        </div>
    </div>
    <button class="success-close" onclick="closeNotification()">√ó</button>
</div>

<div class="top-bar">
    <header>
        <h2>‚úàÔ∏è SkyTicket - H·ªá Th·ªëng ƒê·∫∑t V√© M√°y Bay</h2>
    </header>

    <nav>
        <a th:href="@{/booking/create}">ƒê·∫∑t v√©</a>
        <a th:href="@{/booking/list}">Danh s√°ch v√©</a>
    <!--    <a th:href="@{/flights}">Tra c·ª©u chuy·∫øn bay</a>-->
        <a th:href="@{/logout}">ƒêƒÉng xu·∫•t</a>
    </nav>
</div>

<main>
    <div class="search-section">
        <form th:action="@{/flight/search}" method="get" class="search-form">
            <div class="form-group">
                <label for="departure">ƒêi·ªÉm ƒëi:</label>
                <select id="departure" name="departure" class="form-control" th:value="${departure}" required>
                    <option value="">Ch·ªçn ƒëi·ªÉm ƒëi</option>
                    <option th:each="airport : ${airports}"
                            th:value="${airport.code}"
                            th:text="${airport.code} + ' - ' + ${airport.airportName} + ' (' + ${airport.location} + ')'"
                            th:selected="${airport.code == departure}"></option>
                </select>
            </div>

            <div class="form-group">
                <label for="destination">ƒêi·ªÉm ƒë·∫øn:</label>
                <select id="destination" name="destination" class="form-control" th:value="${destination}" required>
                    <option value="">Ch·ªçn ƒëi·ªÉm ƒë·∫øn</option>
                    <option th:each="airport : ${airports}"
                            th:value="${airport.code}"
                            th:text="${airport.code} + ' - ' + ${airport.airportName} + ' (' + ${airport.location} + ')'"
                            th:selected="${airport.code == destination}"></option>
                </select>
            </div>


            <div class="form-group">
                <label for="date">Ng√†y c·∫•t c√°nh:</label>
                <input type="date" id="date" name="date"
                       th:value="${#temporals.format(date, 'yyyy-MM-dd')}" required>
            </div>

            <div class="form-group">
                <label for="seatClass">H·∫°ng gh·∫ø:</label>
                <select id="seatClass" name="seatClass">
                    <option value="" th:selected="${seatClass == null or seatClass == ''}">T·∫•t c·∫£</option>
                    <option value="Economy" th:selected="${seatClass == 'Economy'}">Economy</option>
                    <option value="Business" th:selected="${seatClass == 'Business'}">Business</option>
                </select>
            </div>

            <button type="submit" class="btn btn-primary">üîç T√¨m chuy·∫øn bay</button>
        </form>
    </div>

    <!--  DANH S√ÅCH CHUY·∫æN BAY -->
    <div class="header">
        <div class="heading">
            <h1>Ô∏è Danh s√°ch L·ªãch bay</h1>
            <p>T√¨m v√† ƒë·∫∑t v√© m√°y bay c·ªßa b·∫°n</p>
        </div>
        <div class="actions">
            <button class="btn btn-ghost" type="button">B·ªô l·ªçc</button>
            <button class="btn btn-primary" type="button">üîÑ L√†m m·ªõi</button>
        </div>
    </div>


        <div class="table-card">
            <div class="table-wrapper">
                <table>
                    <thead>
                    <tr>
                        <th>H√£ng h√†ng kh√¥ng</th>
                        <th>S√¢n bay ƒëi</th>
                        <th>ƒêi·ªÉm c·∫•t c√°nh</th>
                        <th>ƒêi·ªÉm h·∫° c√°nh</th>
                        <th>Ng√†y c·∫•t c√°nh</th>
                        <th>Gi·ªù c·∫•t c√°nh</th>
                        <th>Ng√†y h·∫° c√°nh</th>
                        <th>Gi·ªù h·∫° c√°nh</th>
                        <th>Lo·∫°i gh·∫ø</th>
                        <th>S·ªë gh·∫ø</th>
                        <th>Gi√° v√©</th>
                        <th>Tr·∫°ng th√°i</th>
                        <th>ƒê·∫∑t l·ªãch</th>
                    </tr>
                    </thead>
                    <tbody>
                    <tr th:each="flight : ${flights}">
                        <td th:text="${flight.plane.planeModel}">Airbus A321</td>
                        <td th:text="${flight.plane.airport.airportName}">T√¢n S∆°n Nh·∫•t</td>
                        <td th:text="${flight.takeOff}">SGN</td>
                        <td th:text="${flight.land}">HAN</td>
                        <td th:text="${#temporals.format(flight.takeOffDate, 'dd-MM-yyyy')}">01-01-2025</td>
                        <td th:text="${#temporals.format(flight.takeOffHour, 'HH:mm')}">08:00</td>
                        <td th:text="${#temporals.format(flight.landDate, 'dd-MM-yyyy')}">01-01-2025</td>
                        <td th:text="${#temporals.format(flight.landHour, 'HH:mm')}">10:00</td>
                        <td th:text="${flight.flightSchedule.seatClass}">Economy</td>
                        <td class="num" th:text="${flight.flightSchedule.seatNumber}">1</td>
                        <td class="num">
                            1,500,000 VND
                        </td>
                        <td>
                        <span th:switch="${flight.plane.status}">
                            <span th:case="'Scheduled'" class="status-badge status-scheduled"
                                  th:text="${flight.plane.status}">Scheduled</span>
                            <span th:case="'Ongoing'" class="status-badge status-ongoing"
                                  th:text="${flight.plane.status}">Ongoing</span>
                            <span th:case="'Completed'" class="status-badge status-completed"
                                  th:text="${flight.plane.status}">Completed</span>
                            <span th:case="*" class="status-badge status-cancelled" th:text="${flight.plane.status}">Cancelled</span>
                        </span>

                        </td>
                        <td>
                            <form th:action="@{/booking/create}">
                                <input type="hidden" name="flightId" th:value="${flight.flightPlaneId}" />
                                <button type="submit">ƒê·∫∑t v√© ngay</button>
                            </form>
                        </td>

                    </tr>

                    <tr th:if="${flights == null or flights.isEmpty()}">
                        <td colspan="12">
                            <div class="empty-state">
                                <div class="empty-state-icon">üì≠</div>
                                <p>Kh√¥ng c√≥ l·ªãch bay n√†o.</p>
                                <small>Vui l√≤ng quay l·∫°i sau ho·∫∑c li√™n h·ªá h·ªó tr·ª£ kh√°ch h√†ng.</small>
                            </div>
                        </td>
                    </tr>
                    </tbody>
                </table>
            </div>
        </div>

    <h1>Ch√†o m·ª´ng ƒë·∫øn v·ªõi SkyTicket!</h1>
    <p>H·ªá th·ªëng gi√∫p b·∫°n t√¨m ki·∫øm v√† ƒë·∫∑t v√© m√°y bay d·ªÖ d√†ng, nhanh ch√≥ng.</p>


</main>

<footer>
    <p>¬© 2025 SkyTicket. All rights reserved.</p>
</footer>

<script>
    // T·ª± ƒë·ªông ƒë√≥ng th√¥ng b√°o sau 5 gi√¢y
    const notification = document.getElementById('successNotification');
    if (notification) {
        setTimeout(() => {
            closeNotification();
        }, 5000);
    }

    function closeNotification() {
        const notification = document.getElementById('successNotification');
        if (notification) {
            notification.classList.add('hide');
            setTimeout(() => {
                notification.remove();
            }, 500);
        }
    }

    // Logic ki·ªÉm tra ƒêi·ªÉm ƒëi v√† ƒêi·ªÉm ƒë·∫øn kh√¥ng tr√πng nhau
    document.addEventListener('DOMContentLoaded', function() {
        const searchForm = document.getElementById('searchForm');

        if (searchForm) {
            searchForm.addEventListener('submit', function(event) {
                const departure = document.getElementById('departure').value;
                const destination = document.getElementById('destination').value;

                if (departure && destination && departure === destination) {
                    event.preventDefault(); // NgƒÉn ch·∫∑n form g·ª≠i ƒëi
                    alert('ƒêi·ªÉm ƒëi v√† ƒêi·ªÉm ƒë·∫øn kh√¥ng ƒë∆∞·ª£c tr√πng nhau. Vui l√≤ng ch·ªçn l·∫°i.');
                }
            });
        }
    });
</script>
</body>
</html>
