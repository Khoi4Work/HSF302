<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="en">
<head>
    <meta charset="UTF-8">
    <title>SkyTicket - Trang Ch√≠nh</title>
    <link rel="stylesheet" th:href="@{/admin.css}">
</head>
<body>

<!-- Th√¥ng b√°o ƒëƒÉng nh·∫≠p th√†nh c√¥ng -->
<div th:if="${loginSuccess}" id="successNotification" class="success-notification">
    <div class="success-icon"></div>
    <div class="success-content">
        <div class="success-title">üéâ ƒêƒÉng nh·∫≠p th√†nh c√¥ng!</div>
        <div class="success-message">
            <span th:if="${admin != null and admin.fullName != null}" th:text="'Ch√∫c m·ª´ng b·∫°n ' + ${admin.fullName} + '!'">Ch√∫c m·ª´ng b·∫°n!</span>
            <span th:if="${admin == null or admin.fullName == null}">Ch√∫c m·ª´ng b·∫°n!</span>
        </div>
    </div>
    <button class="success-close" onclick="closeNotification()">√ó</button>
</div>

<header>
    <h2>‚úàÔ∏è SkyTicket - H·ªá Th·ªëng ƒê·∫∑t V√© M√°y Bay</h2>

    <span th:if="${admin != null}" th:text="${admin.fullName}">Admin</span>
</header>


<main>
    <!-- Navbar -->
    <nav class="navbar">
        <div class="navbar-center">
            <a th:href="@{/schedule/admin}" class="nav-link">üè† Trang ch·ªß</a>
            <a th:href="@{/schedule/admin/users}" class="nav-link">üë§ Qu·∫£n l√Ω ng∆∞·ªùi d√πng</a>
            <a th:href="@{/schedule/addSchedule}" class="nav-link">üõ´ Th√™m l·ªãch bay</a>
            <a th:href="@{/schedule/payment}" class="nav-link">Giao d·ªãch</a>
        </div>
        <div class="navbar-right">

            <a th:href="@{/logout}" class="logout-btn">ƒêƒÉng xu·∫•t</a>
        </div>
    </nav>
    <div class="header">
        <div class="search-section">
            <form th:action="@{/flight/search}" method="get" class="search-form">
                <div class="form-group">
                    <label for="departure">ƒêi·ªÉm ƒëi:</label>
                    <input type="text" id="departure" name="departure"
                           th:value="${departure}" placeholder="V√≠ d·ª•: SGN" required>
                </div>

                <div class="form-group">
                    <label for="destination">ƒêi·ªÉm ƒë·∫øn:</label>
                    <input type="text" id="destination" name="destination"
                           th:value="${destination}" placeholder="V√≠ d·ª•: HAN" required>
                </div>

                <div class="form-group">
                    <label for="date">Ng√†y c·∫•t c√°nh:</label>
                    <input type="date" id="date" name="date"
                           th:value="${#temporals.format(date, 'yyyy-MM-dd')}" required>
                </div>

                <input name="page" id="page" type="hidden" th:value="1" >

                <button type="submit" class="btn btn-primary">üîç T√¨m chuy·∫øn bay</button>
            </form>
        </div>

        <div class="heading">
            <h1>Ô∏è Danh s√°ch L·ªãch bay</h1>
        </div>
        <div class="actions">
            <button class="btn btn-primary" type="reset">üîÑ L√†m m·ªõi</button>
        </div>
    </div>

    <div class="table-card">
        <div class="table-wrapper">
            <table>
                <thead>
                <tr>
                    <th>H√£ng h√†ng kh√¥ng</th>
                    <th>S√¢n bay ƒëi</th>
                    <th>ƒêi·ªÉm c·∫•t c√°nh</th>
                    <th>ƒêi·ªÉm h·∫° c√°nh</th>
                    <th>Ng√†y c·∫•t c√°nh</th>
                    <th>Gi·ªù c·∫•t c√°nh</th>
                    <th>Ng√†y h·∫° c√°nh</th>
                    <th>Gi·ªù h·∫° c√°nh</th>
                    <th>Lo·∫°i gh·∫ø</th>
                    <th>S·ªë gh·∫ø</th>
                    <th>Gi√° v√©</th>
                    <th>Tr·∫°ng th√°i</th>
                    <th>Ch·ªânh s·ª≠a</th>
                </tr>
                </thead>
                <tbody>
                <tr th:each="flight : ${schedules}">
                    <td th:text="${flight.plane.planeModel}">Airbus A321</td>
                    <td th:text="${flight.plane.airport.airportName}">T√¢n S∆°n Nh·∫•t</td>
                    <td th:text="${flight.takeOff}">SGN</td>
                    <td th:text="${flight.land}">HAN</td>
                    <td th:text="${#temporals.format(flight.takeOffDate, 'dd-MM-yyyy')}">01-01-2025</td>
                    <td th:text="${#temporals.format(flight.takeOffHour, 'HH:mm')}">08:00</td>
                    <td th:text="${#temporals.format(flight.landDate, 'dd-MM-yyyy')}">01-01-2025</td>
                    <td th:text="${#temporals.format(flight.landHour, 'HH:mm')}">10:00</td>
                    <td th:text="${flight.flightSchedule.seatClass}">Economy</td>
                    <td class="num" th:text="${flight.flightSchedule.seatNumber}">1</td>
                    <td class="num" th:text="${flight.flightSchedule.price}"></td>
                    <td>
                        <span th:switch="${flight.plane.status}">
                            <span th:case="'Scheduled'" class="status-badge status-scheduled"
                                  th:text="${flight.plane.status}">Scheduled</span>
                            <span th:case="'Ongoing'" class="status-badge status-ongoing"
                                  th:text="${flight.plane.status}">Ongoing</span>
                            <span th:case="'Completed'" class="status-badge status-completed"
                                  th:text="${flight.plane.status}">Completed</span>
                            <span th:case="*" class="status-badge status-cancelled" th:text="${flight.plane.status}">Cancelled</span>
                        </span>

                    </td>
                    <td>
                        <a th:href="@{'/schedule/editSchedule/' +${flight.flightPlaneId}}" class="btn">Edit Schedule</a>
                        <a th:href="@{'/schedule/deleteSchedule/' +${flight.flightPlaneId}}" class="btn"
                           onclick="return confirm('B·∫°n c√≥ ch·∫Øc ch·∫Øn mu·ªën x√≥a l·ªãch bay n√†y?');">Delete</a>
                    </td>
                </tr>
                <tr th:if="${schedules == null or schedules.isEmpty()}">
                    <td colspan="13">
                        <div class="empty-state">
                            <div class="empty-state-icon">üì≠</div>
                            <p>Kh√¥ng c√≥ l·ªãch bay n√†o.</p>
                            <small>Vui l√≤ng quay l·∫°i sau ho·∫∑c li√™n h·ªá h·ªó tr·ª£ kh√°ch h√†ng.</small>
                        </div>
                    </td>
                </tr>
                </tbody>
            </table>
        </div>
    </div>

</main>

<footer>
    <p>¬© 2025 SkyTicket. All rights reserved.</p>
</footer>

<script>
    // T·ª± ƒë·ªông ƒë√≥ng th√¥ng b√°o sau 5 gi√¢y
    const notification = document.getElementById('successNotification');
    if (notification) {
        setTimeout(() => {
            closeNotification();
        }, 5000);
    }

    function closeNotification() {
        const notification = document.getElementById('successNotification');
        if (notification) {
            notification.classList.add('hide');
            setTimeout(() => {
                notification.remove();
            }, 500);
        }
    }
</script>
</body>
</html>
